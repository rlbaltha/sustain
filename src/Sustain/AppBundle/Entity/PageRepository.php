<?php

namespace Sustain\AppBundle\Entity;

use Doctrine\ORM\EntityRepository;

/**
 * PageRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class PageRepository extends EntityRepository
{
    /**
     * Find pages for homepage
     * @return Page
     */
    public function findHome()
    {
        return $this->createQueryBuilder('p')
            ->andWhere('p.homepage = :switch')
            ->setParameter('switch',true)
            ->orderBy('p.sortorder','ASC')
            ->getQuery()
            ->getResult();
    }

    /**
     * Find pages for stories
     * @return Page
     */
    public function findStories()
    {
        return $this->createQueryBuilder('p')
          ->andWhere('p.section = :id')
          ->setParameter('id','1')
          ->orderBy('p.created','DESC')
          ->getQuery()
          ->getResult();
    }

    /**
     * Find pages for stories
     * @return Page
     */
    public function findNewStories()
    {
        return $this->createQueryBuilder('p')
            ->join("p.section", "s")
            ->andwhere('s.display=:display')
            ->setParameter('display', true)
            ->orderBy('p.created','DESC')
            ->setMaxResults('6')
            ->getQuery()
            ->getResult();
    }
}
